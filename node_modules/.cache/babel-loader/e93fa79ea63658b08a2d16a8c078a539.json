{"ast":null,"code":"var _jsxFileName = \"/home/demonwolf/WebstormProjects/SPE-final-project/client/src/App.js\";\nimport 'react-bootstrap';\nimport React, { useState, useEffect } from 'react';\nimport './App.css';\nimport Web3 from 'web3';\nimport ModelABI from './contracts/Model.json';\nimport RegisterScreen from \"./components/RegisterScreen\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Welcome extends React.Component {\n  async componentWillMount() {\n    await this.loadWeb3();\n    await this.connectBlockChainData();\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentAccount: 0x0,\n      contract: null,\n      existingUser: null\n    };\n  }\n\n  async getUserState(contract) {\n    let rvalue = false;\n\n    while (this.state.contract !== null) {\n      await this.state.contract.methods.userExist(this.state.currentAccount).call().then(function (result) {\n        rvalue = result;\n      });\n    }\n\n    this.setState({\n      existingUser: rvalue\n    });\n    console.log(rvalue);\n    return rvalue;\n  }\n\n  async addUser(name, location, email, phone) {\n    await this.state.contract.methods.addUser(name, location, email, phone).send({\n      from: this.state.currentAccount\n    });\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum);\n      await window.ethereum.enable();\n    } else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider);\n    } else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n    }\n  }\n\n  async RegisterUser(name, location, email, phone) {\n    await this.contract.methods.addUser(name, location, email, phone).send({\n      from: this.state.currentAccount\n    }).then(function (result) {\n      console.log(result);\n    });\n  }\n\n  async connectBlockChainData() {\n    const web3 = await new Web3(Web3.givenProvider || \"http://localhost:8545\");\n    const accounts = await web3.eth.getAccounts();\n    this.setState({\n      currentAccount: accounts[0]\n    });\n    console.log(accounts[0]);\n    console.log(this.state.currentAccount);\n    const networkId = await web3.eth.net.getId();\n    const networkData = ModelABI.networks[networkId];\n\n    if (networkData) {\n      const Model = await new web3.eth.Contract(ModelABI.abi, networkData.address);\n      this.setState({\n        contract: Model\n      });\n      const x = await Model.methods.getAllUsers().call();\n      console.log(this.state.contract);\n      console.log(x);\n      let z = await Model.methods.Users(x[0]).call();\n      console.log(z);\n      let iop = await this.getUserState(this.state.contract);\n      this.setState({\n        existingUser: iop\n      });\n    } else {\n      window.alert(\"Please switch to Ganache Network!!\");\n    }\n  }\n\n  RegisterScreenLoader() {\n    if (this.state.existingUser === false) return /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"hello\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 16\n    }, this);else return /*#__PURE__*/_jsxDEV(RegisterScreen, {\n      Account: this.state.currentAccount,\n      Contract: this.state.contract\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 16\n    }, this);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: this.RegisterScreenLoader\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }, this);\n  }\n\n}\n\nexport default Welcome;","map":{"version":3,"sources":["/home/demonwolf/WebstormProjects/SPE-final-project/client/src/App.js"],"names":["React","useState","useEffect","Web3","ModelABI","RegisterScreen","Welcome","Component","componentWillMount","loadWeb3","connectBlockChainData","constructor","props","state","currentAccount","contract","existingUser","getUserState","rvalue","methods","userExist","call","then","result","setState","console","log","addUser","name","location","email","phone","send","from","window","ethereum","web3","enable","currentProvider","alert","RegisterUser","givenProvider","accounts","eth","getAccounts","networkId","net","getId","networkData","networks","Model","Contract","abi","address","x","getAllUsers","z","Users","iop","RegisterScreenLoader","render"],"mappings":"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","sourcesContent":["import 'react-bootstrap'\nimport React, {useState, useEffect} from 'react';\nimport './App.css';\nimport Web3 from 'web3'\nimport ModelABI from './contracts/Model.json';\nimport RegisterScreen from \"./components/RegisterScreen\";\n\n\nclass  Welcome extends React.Component{\n    async componentWillMount() {\n        await this.loadWeb3();\n        await this.connectBlockChainData();\n    }\n\n    constructor(props) {\n        super(props);\n        this.state={currentAccount: 0x0, contract: null, existingUser :null};\n    }\n\n    async getUserState (contract){\n        let rvalue = false;\n        while(this.state.contract !== null){\n         await  this.state.contract.methods.userExist( this.state.currentAccount).call()\n          .then(function (result){\n              rvalue = result;\n          });}\n        this.setState({existingUser:rvalue});\n        console.log(rvalue);\n      return rvalue;\n    }\n\n  async addUser(name, location, email, phone){\n        await  this.state.contract\n        .methods\n        .addUser(name, location, email, phone)\n        .send({from :  this.state.currentAccount});\n\n}\n\n\n  async loadWeb3(){\n      if (window.ethereum) {\n          window.web3 = new Web3(window.ethereum)\n          await window.ethereum.enable()\n      } else if (window.web3) {\n          window.web3 = new Web3(window.web3.currentProvider)\n      } else {\n          window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n      }\n  }\n  async RegisterUser(name, location, email, phone){\n        await  this.contract\n        .methods\n        .addUser(name, location, email, phone)\n        .send({from :  this.state.currentAccount}).then(function(result){\n            console.log(result);\n        });\n  }\n\n\n\n  async connectBlockChainData(){\n    const web3 = await new Web3(Web3.givenProvider || \"http://localhost:8545\")\n    const accounts = await web3.eth.getAccounts()\n    this.setState({currentAccount:accounts[0]});\n    console.log(accounts[0]);\n    console.log( this.state.currentAccount);\n    const networkId = await web3.eth.net.getId();\n    const networkData = ModelABI.networks[networkId];\n    if(networkData){\n      const Model = await new web3.eth.Contract(ModelABI.abi,networkData.address);\n      this.setState({contract :Model});\n      const x = await Model.methods.getAllUsers().call();\n      console.log(this.state.contract);\n      console.log(x);\n      let z = await Model.methods.Users(x[0]).call();\n      console.log(z);\n      let iop = await this.getUserState(this.state.contract);\n      this.setState({existingUser : iop});\n    }\n    else{\n      window.alert(\"Please switch to Ganache Network!!\")\n    }\n  }\n\n  RegisterScreenLoader(){\n\n    if( this.state.existingUser === false)\n        return <h1>hello</h1>\n    else\n        return <RegisterScreen Account ={ this.state.currentAccount}  Contract = { this.state.contract} />\n\n  }\n\n  render() {\n      return (\n\n          <div className=\"App\">\n              {\n\n                  this.RegisterScreenLoader\n              }\n\n          </div>);\n  }\n}\n\nexport default Welcome;\n"]},"metadata":{},"sourceType":"module"}